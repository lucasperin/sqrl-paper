\begin{figure}[ht]
	\begin{tikzpicture}
		\matrix (m)[matrix of nodes, column  sep=4mm,row  sep=2mm, 
					nodes={draw=none, anchor=center,text depth=0pt} ]
		{
		SQRL App & User & ASP & Step\\
		 & & Generates nonce & $1$ \\
		 & & Displays QR code & $2$ \\
		& scans QR code & & 3 \\[-2mm]
		& using SQRL App & & \\
		Signs nonce with PK & & & 4 \\
		Sends signed nonce & & & 5\\
		& & Validates signed nonce & 6\\
		& & Sends authenticated & 7\\[-2mm]
		& & session to user's device& \\[-2mm]
		};

		\draw (m-1-1.south east)--(m-1-1.south west);
		\draw (m-1-2.south east)--(m-1-2.south west);
		\draw (m-1-3.south east)--(m-1-3.south west);
		\draw[-latex] (m-3-3.south east)--(m-4-2.north east);
		\draw[-latex] (m-5-2.south east)--(m-6-1.north east);
		\draw[-latex] (m-7-1.south west)--(m-8-3.north west);
	\end{tikzpicture}
	\caption{SQRL Authentication Phase}
	\label{fig:sqrlauth}
\end{figure}
