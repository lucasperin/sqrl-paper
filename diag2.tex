\begin{figure}[ht]
	\begin{tikzpicture}
		\matrix (m)[matrix of nodes, column  sep=4mm,row  sep=2mm, 
					nodes={draw=none, anchor=center,text depth=0pt} ]
		{
		Scanner & User & ASP & Step\\
		 & & Generates nonce & $1$ \\
		 & & Displays visual code & $2$ \\
		& scans visual code & & 3 \\[-2mm]
		& and website domain & & \\
		Produce proof of& & & 4 \\[-2mm]
		authentication & & &\\
		Sends authentication & & & 5\\[-2mm]
		proof & & & \\
		& & Validates proof & 6\\
		& & Accepts/Rejects & 7\\
		};

		\draw (m-1-1.south east)--(m-1-1.south west);
		\draw (m-1-2.south east)--(m-1-2.south west);
		\draw (m-1-3.south east)--(m-1-3.south west);
		\draw[-latex] (m-3-3.south east)--(m-3-3.south west);
		\draw[-latex] (m-5-2.south east)--(m-5-2.south west);
		\draw[shorten <=-1cm, shorten >=-1cm, -latex] (m-9-1.south west)--(m-9-1.south east);
	\end{tikzpicture}
	\caption{General visual based authentication protocol}
	\label{fig:genauth}
\end{figure}
