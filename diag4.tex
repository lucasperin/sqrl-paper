\begin{figure}[ht]
	\begin{tikzpicture}
		\matrix (m)[matrix of nodes, column  sep=4mm,row  sep=2mm, 
					nodes={draw=none, anchor=center,text depth=0pt} ]
		{
		Scanner & User & ASP & Step\\
		 & & Displays visual code & $1$ \\
		& scans website domain & & 2\\
		Produce proof of& & & 3 \\[-2mm]
		authentication & & &\\
		Sends authentication & & & 4\\[-2mm]
		proof & & & \\
		& & Validates proof & 6\\
		& & Sends authenticated & 7\\[-2mm]
		& & session & \\
		Authenticates user's & & &\\[-2mm]
		device& & &\\
		};

		\draw (m-1-1.south east)--(m-1-1.south west);
		\draw (m-1-2.south east)--(m-1-2.south west);
		\draw (m-1-3.south east)--(m-1-3.south west);
		\draw[-latex] (m-2-3.south east)--(m-3-2.north east);
		\draw[-latex] (m-3-2.south east)--(m-4-1.north east);
		\draw[-latex] (m-7-1.south west)--(m-8-3.north west);
		\draw[-latex] (m-10-3.south west)--(m-11-1.north east);
	\end{tikzpicture}
	\caption{General visual based authentication protocol}
	\label{fig:proposal}
\end{figure}
